const QUESTIONS=[{de:"F√ºhlte ich mich kleiner oder falsch nach dem Kontakt?",en:"Did I feel small or wrong after the encounter?"},{de:"Musste ich mich rechtfertigen oder erkl√§ren?",en:"Did I have to justify or explain myself?"},{de:"Wurde mein 'Nein' ignoriert oder bestraft?",en:"Was my 'No' ignored or punished?"},{de:"War das Verhalten abh√§ngig davon, ob die Person etwas bekommt?",en:"Was the behavior dependent on getting something?"},{de:"Wurde Schuld verschoben ('wegen dir ...')?",en:"Was blame shifted ('because of you...')?"},{de:"Musste ich Energie geben, ohne etwas zur√ºckzubekommen?",en:"Did I give energy without getting anything back?"},{de:"Habe ich Angst, ehrlich zu sein?",en:"Am I afraid to be honest?"}];let answers=Array(QUESTIONS.length).fill(null);let score=0;let lang='de';const qContainer=document.getElementById('questions');const resultEl=document.getElementById('result');const historyList=document.getElementById('history-list');const themeToggle=document.getElementById('theme-toggle');const langSelect=document.getElementById('lang-select');const saveRunBtn=document.getElementById('save-run');const clearHistoryBtn=document.getElementById('clear-history');function renderQuestions(){qContainer.innerHTML='';QUESTIONS.forEach((q,i)=>{const div=document.createElement('div');div.className='question';const txt=document.createElement('div');txt.className='q-text';txt.innerText=q[lang];const btns=document.createElement('div');btns.className='q-buttons';const yes=document.createElement('button');yes.className='btn btn-yes';yes.innerText='JA';const no=document.createElement('button');no.className='btn btn-no';no.innerText='NEIN';yes.onclick=()=>{setAnswer(i,true);div.style.opacity=0.6;setTimeout(()=>div.remove(),220);};no.onclick=()=>{setAnswer(i,false);div.style.opacity=0.6;setTimeout(()=>div.remove(),220);};btns.appendChild(yes);btns.appendChild(no);div.appendChild(txt);div.appendChild(btns);qContainer.appendChild(div);});}function setAnswer(i,val){answers[i]=val;score=answers.filter(a=>a===true).length;if(answers.every(a=>a!==null))updateResult();}function updateResult(){let text='',level='';if(score<=2){text=lang==='de'?'‚úÖ Beziehung wirkt gesund.':'‚úÖ Relationship seems healthy.';level='safe';}else if(score<=4){text=lang==='de'?'‚ö†Ô∏è Warnung: Muster zeigen sich.':'‚ö†Ô∏è Warning: patterns appear.';level='caution';}else if(score<=6){text=lang==='de'?'üü† Hochrisiko: Vorsicht.':'üü† High Risk: Caution.';level='warning';}else{text=lang==='de'?'üö® Sehr hochtoxisch: Grenzen dringend.':'üö® Extremely toxic: set boundaries.';level='danger';}resultEl.innerHTML=`<div class='result--${level}'>${text}<div style='margin-top:8px;font-size:0.9rem;opacity:0.85'>Score: ${score}/${QUESTIONS.length}</div></div>`;}function saveHistory(){const history=JSON.parse(localStorage.getItem('toxx_history')||'[]');history.unshift({timestamp:new Date().toISOString(),score,answers});localStorage.setItem('toxx_history',JSON.stringify(history));renderHistory();}function clearHistory(){localStorage.removeItem('toxx_history');renderHistory();}function renderHistory(){const history=JSON.parse(localStorage.getItem('toxx_history')||'[]');if(!history.length){historyList.innerText=lang==='de'?'Keine Eintr√§ge':'No entries';return;}historyList.innerHTML='';history.forEach(h=>{const div=document.createElement('div');div.className='history-item';const meta=document.createElement('div');meta.className='history-meta';meta.innerText=`${new Date(h.timestamp).toLocaleString()} ‚Äî Score ${h.score}/${QUESTIONS.length}`;div.appendChild(meta);historyList.appendChild(div);});}themeToggle.addEventListener('click',()=>{document.body.classList.toggle('light');});langSelect.addEventListener('change',(e)=>{lang=e.target.value;renderQuestions();renderHistory();});saveRunBtn.addEventListener('click',()=>{if(answers.some(a=>a===null)){alert(lang==='de'?'Bitte alle Fragen beantworten':'Answer all questions first');return;}saveHistory();alert(lang==='de'?'Eintrag gespeichert':'Entry saved');});clearHistoryBtn.addEventListener('click',()=>{if(confirm(lang==='de'?'History l√∂schen?':'Clear history?'))clearHistory();});renderQuestions();renderHistory();